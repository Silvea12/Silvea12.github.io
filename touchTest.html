<!DOCTYPE html5>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Touch demo</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
	<style type="text/css">
		body {
			margin: 0;
			padding: 0;
			position: fixed;
			overflow: hidden;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		var canvas = document.createElement("canvas");
		canvas.height = window.innerHeight;
		canvas.width = window.innerWidth;
		document.body.appendChild(canvas);
		var ctx = canvas.getContext("2d");
		var x = 0,
			y = 0,
			drawing = false;

		var queueDraw = false;

		window.addEventListener('resize', function() {
			canvas.height = window.innerHeight;
			canvas.width = window.innerWidth;
			draw();
		});

		function setCircle(touchData) {
			x = touchData.clientX;
			y = touchData.clientY;
			console.log(x*100/canvas.width, 100-(y*100/canvas.height));
			drawing = true;
			if (!queueDraw) {
				queueDraw = true;
				requestAnimationFrame(draw);
			}
		}

		function draw() {
			queueDraw = false;
			console.log("DRAWING");
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.font = "12px serif";

			ctx.beginPath();
			for (var i = 0; i < 11; i++) {
				ctx.moveTo(0, i * canvas.height/10);
				ctx.lineTo(canvas.width, i * canvas.height/10);
				ctx.fillText(((10-i) * 10) + "%", 5, i * canvas.height/10 + canvas.height/20 + 6);
			}
			ctx.closePath();
			ctx.stroke();

			if (drawing) {
				ctx.fillRect(x - 10, y - 10, 20, 20);
			}
			if (queueDraw) {
				requestAnimationFrame(draw);
			}
		}

		draw();

		document.body.addEventListener('touchstart', function(evt) {
			evt.preventDefault();
			setCircle(evt.targetTouches[0]);
			navigator.vibrate(100);
		});

		document.body.addEventListener('touchmove', function(evt) {
			evt.preventDefault();
			setCircle(evt.targetTouches[0]);
		});

		document.body.addEventListener('touchend', function(evt) {
			evt.preventDefault();
			drawing = false;
			if (!queueDraw) {
				queueDraw = true;
				requestAnimationFrame(draw);
			}
		});
	</script>
</body>
</html>
